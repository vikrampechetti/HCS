/**
 * 
 */
package com.HCS.ioc.events.main;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;

import org.aeonbits.owner.ConfigFactory;
import org.json.JSONArray;
import org.json.JSONObject;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.HCS.ioc.api.config.APIConfig;
import com.HCS.ioc.createDatasource.CreateDataSourceRecord;
import com.HCS.ioc.createDatasource.DeleteDataSourceRecord;
import com.HCS.ioc.devices.main.DevicesMainTest;

/**
 * @author BALA CHANDER Apr 21, 2017 
 *
 */
public class EventsMainTest {
	static Logger logger = LoggerFactory.getLogger(DevicesMainTest.class);
	static APIConfig config = ConfigFactory.create(APIConfig.class);

	public void createDataSourceForEvents(String payload){
		
		//String payload = "{\r\n  \"meta\": {\r\n    \"count\": 17,\r\n    \"previous\": null,\r\n    \"next\": null\r\n  },\r\n  \"results\": [\r\n    {\r\n      \"id\": 1,\r\n      \"created\": \"2016-12-28 21:20:33\",\r\n      \"modified\": \"2016-12-28 21:20:33\",\r\n      \"status\": \"\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2016-12-28 15:50:33\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": null,\r\n      \"direction\": null,\r\n      \"cause\": null,\r\n      \"type\": null,\r\n      \"subcause\": null,\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": null,\r\n      \"latitude\": \"17.44538\",\r\n      \"longitude\": \"78.376963\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 2,\r\n      \"created\": \"2016-12-28 21:22:52\",\r\n      \"modified\": \"2016-12-28 21:45:42\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2016-12-28 15:52:52\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Natural Disaster\",\r\n      \"direction\": null,\r\n      \"cause\": \"Congestion\",\r\n      \"type\": \"Queue\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": null,\r\n      \"latitude\": \"17.4473260743\",\r\n      \"longitude\": \"78.376218705\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"created\": \"2016-12-29 11:30:43\",\r\n      \"modified\": \"2017-04-19 14:19:15\",\r\n      \"status\": \"closed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2016-12-29 06:00:43\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Minor\",\r\n      \"direction\": null,\r\n      \"cause\": \"Vehicle Stall\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": null,\r\n      \"latitude\": \"17.435915\",\r\n      \"longitude\": \"78.393849\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 4,\r\n      \"created\": \"2016-12-29 16:55:02\",\r\n      \"modified\": \"2016-12-29 16:56:36\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2016-12-29 11:25:02\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Minor\",\r\n      \"direction\": null,\r\n      \"cause\": \"Vehicle Stall\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": null,\r\n      \"latitude\": \"17.4463836982\",\r\n      \"longitude\": \"78.377583384\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [\r\n        {\r\n          \"status\": \"Test\",\r\n          \"dispatch_time\": \"2017-04-01 04:00:00\",\r\n          \"arrival_time\": \"2017-04-01 07:00:00\",\r\n          \"departure_time\": \"2017-04-01 10:00:00\",\r\n          \"decline_time\": null,\r\n          \"vehicle_type\": \"Delivery van\",\r\n          \"agency_name\": \"Ambulance\"\r\n        }\r\n      ],\r\n      \"injuries\": [\r\n        {\r\n          \"is_confirmed\": true,\r\n          \"count\": 1,\r\n          \"injury_type\": 1\r\n        },\r\n        {\r\n          \"is_confirmed\": true,\r\n          \"count\": 3,\r\n          \"injury_type\": 2\r\n        },\r\n        {\r\n          \"is_confirmed\": true,\r\n          \"count\": 3,\r\n          \"injury_type\": 2\r\n        }\r\n      ],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 5,\r\n      \"created\": \"2016-12-29 17:26:05\",\r\n      \"modified\": \"2017-04-01 15:33:11\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2016-12-29 11:56:05\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Major\",\r\n      \"direction\": null,\r\n      \"cause\": \"Obstruction\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Tree on Road\",\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": null,\r\n      \"latitude\": \"17.4440161844\",\r\n      \"longitude\": \"78.3771845678\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"created\": \"2016-12-30 19:40:56\",\r\n      \"modified\": \"2016-12-30 19:40:56\",\r\n      \"status\": \"\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2016-12-30 14:10:56\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": null,\r\n      \"direction\": null,\r\n      \"cause\": null,\r\n      \"type\": null,\r\n      \"subcause\": null,\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": null,\r\n      \"latitude\": \"17.4536158284\",\r\n      \"longitude\": \"78.3709169472\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 7,\r\n      \"created\": \"2017-03-31 15:47:03\",\r\n      \"modified\": \"2017-03-31 15:47:27\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-03-31 15:47:02\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Major\",\r\n      \"direction\": \"NW\",\r\n      \"cause\": \"Forest Fire\",\r\n      \"type\": \"Weather Conditions\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"\",\r\n      \"latitude\": \"17.449428\",\r\n      \"longitude\": \"78.37334\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Zensar Technologies Ltd\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 8,\r\n      \"created\": \"2017-04-01 15:38:02\",\r\n      \"modified\": \"2017-04-01 15:38:02\",\r\n      \"status\": \"unconfirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-01 15:38:02\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": null,\r\n      \"direction\": \"south\",\r\n      \"cause\": null,\r\n      \"type\": null,\r\n      \"subcause\": null,\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"Hi Tech City Main Road\",\r\n      \"latitude\": \"17.4459257886\",\r\n      \"longitude\": \"78.3774231709\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Hardhik Crown\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 9,\r\n      \"created\": \"2017-04-01 15:38:02\",\r\n      \"modified\": \"2017-04-01 15:38:02\",\r\n      \"status\": \"unconfirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-01 15:38:02\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": null,\r\n      \"direction\": \"south\",\r\n      \"cause\": null,\r\n      \"type\": null,\r\n      \"subcause\": null,\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"Hi Tech City Main Road\",\r\n      \"latitude\": \"17.4459257886\",\r\n      \"longitude\": \"78.3774231709\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Hardhik Crown\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 10,\r\n      \"created\": \"2017-04-01 15:38:02\",\r\n      \"modified\": \"2017-04-01 15:38:02\",\r\n      \"status\": \"unconfirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-01 15:38:02\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": null,\r\n      \"direction\": \"south\",\r\n      \"cause\": null,\r\n      \"type\": null,\r\n      \"subcause\": null,\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"Hi Tech City Main Road\",\r\n      \"latitude\": \"17.4459257886\",\r\n      \"longitude\": \"78.3774231709\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Hardhik Crown\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 11,\r\n      \"created\": \"2017-04-01 15:38:02\",\r\n      \"modified\": \"2017-04-01 15:38:02\",\r\n      \"status\": \"unconfirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-01 15:38:02\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": null,\r\n      \"direction\": \"south\",\r\n      \"cause\": null,\r\n      \"type\": null,\r\n      \"subcause\": null,\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"Hi Tech City Main Road\",\r\n      \"latitude\": \"17.4459257886\",\r\n      \"longitude\": \"78.3774231709\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Hardhik Crown\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 12,\r\n      \"created\": \"2017-04-01 15:38:02\",\r\n      \"modified\": \"2017-04-01 15:38:02\",\r\n      \"status\": \"unconfirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-01 15:38:02\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": null,\r\n      \"direction\": \"south\",\r\n      \"cause\": null,\r\n      \"type\": null,\r\n      \"subcause\": null,\r\n      \"owner\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"Hi Tech City Main Road\",\r\n      \"latitude\": \"17.4459257886\",\r\n      \"longitude\": \"78.3774231709\",\r\n      \"created_by\": {\r\n        \"username\": \"admin\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"nitin.kalal@ibigroup.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Hardhik Crown\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 13,\r\n      \"created\": \"2017-04-12 14:08:03\",\r\n      \"modified\": \"2017-04-12 14:08:21\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-12 14:08:03\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"None\",\r\n      \"direction\": \"NW\",\r\n      \"cause\": \"Collision\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"\",\r\n      \"latitude\": \"17.4480739912\",\r\n      \"longitude\": \"78.374283402\",\r\n      \"created_by\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Dell Gate 2\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 14,\r\n      \"created\": \"2017-04-12 14:15:06\",\r\n      \"modified\": \"2017-04-12 14:19:29\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": 60,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-12 14:15:06\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Minor\",\r\n      \"direction\": \"NW\",\r\n      \"cause\": \"Collision\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"\",\r\n      \"latitude\": \"17.450927\",\r\n      \"longitude\": \"78.371825\",\r\n      \"created_by\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Nhance Engineering Solution\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 15,\r\n      \"created\": \"2017-04-12 14:27:09\",\r\n      \"modified\": \"2017-04-12 14:33:39\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-12 14:27:09\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Minor\",\r\n      \"direction\": \"south\",\r\n      \"cause\": \"Collision\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"\",\r\n      \"latitude\": \"17.4472109365\",\r\n      \"longitude\": \"78.3745959763\",\r\n      \"created_by\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"APIIC\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 16,\r\n      \"created\": \"2017-04-19 14:21:01\",\r\n      \"modified\": \"2017-04-19 14:23:34\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-19 14:21:01\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Major\",\r\n      \"direction\": \"west\",\r\n      \"cause\": \"Collision\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"\",\r\n      \"latitude\": \"17.4435166722\",\r\n      \"longitude\": \"78.3764948869\",\r\n      \"created_by\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Lemon Tree Premier HITEC City Hyderabad\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [\r\n        {\r\n          \"is_confirmed\": true,\r\n          \"count\": 2,\r\n          \"injury_type\": 2\r\n        }\r\n      ],\r\n      \"vehicles_involved\": []\r\n    },\r\n    {\r\n      \"id\": 17,\r\n      \"created\": \"2017-04-19 15:48:40\",\r\n      \"modified\": \"2017-04-19 15:51:02\",\r\n      \"status\": \"confirmed\",\r\n      \"estimated_duration\": null,\r\n      \"confirmed_timestamp\": null,\r\n      \"occurrence_time\": \"2017-04-19 15:48:40\",\r\n      \"closed_timestamp\": null,\r\n      \"rejected_timestamp\": null,\r\n      \"description\": \"\",\r\n      \"severity\": \"Minor\",\r\n      \"direction\": \"NE\",\r\n      \"cause\": \"Collision\",\r\n      \"type\": \"Incident\",\r\n      \"subcause\": \"Any\",\r\n      \"owner\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"roadway_name\": \"Hi Tech City Main Road\",\r\n      \"latitude\": \"17.4487868476\",\r\n      \"longitude\": \"78.3790451158\",\r\n      \"created_by\": {\r\n        \"username\": \"landt\",\r\n        \"first_name\": \"\",\r\n        \"last_name\": \"\",\r\n        \"email\": \"testlandt@gmail.com\",\r\n        \"contact_no\": \"\"\r\n      },\r\n      \"nearby_landmark\": \"Indian Oil Petrol Pump\",\r\n      \"blockage\": null,\r\n      \"responder_vehicle\": [],\r\n      \"injuries\": [],\r\n      \"vehicles_involved\": []\r\n    }\r\n  ]\r\n}\r\n";
		try {
			// Deleting datasource records
//			try{
//				File deleteRecordsIdTempFile = new File(config.eventsDSRecordsIDTempFile());
//				FileReader deleteRecordsIdTempFileReader = new FileReader(deleteRecordsIdTempFile);
//				BufferedReader deleteRecordsIdTempFileBufReader = new BufferedReader(deleteRecordsIdTempFileReader);
//				
//				DeleteDataSourceRecord dataSourceRecord = new DeleteDataSourceRecord();
//				int recordObjID = Integer.parseInt(deleteRecordsIdTempFileBufReader.readLine());
//				int errorCount = 0;
//				while(recordObjID > 0){
//					String response = dataSourceRecord.deleteDataSourceRecord(config.eventsDatasourceID(), String.valueOf(recordObjID));
//					logger.info("{ RESPONSE OF DELETE }"+response);
//					if(response.contains("200")){
//						FileWriter writer = new FileWriter(deleteRecordsIdTempFile);
//						writer.write(recordObjID);
//						writer.close();
//					}else{
//						errorCount ++;
//						if(errorCount==5){
//							break;
//						}
//					}
//					recordObjID++;
//				}
//			}catch(Exception e){
//				logger.error("{	Exception @ deleting Records	}	"+e);
//			}
			
			File file = new File(config.eventstempFile());
			FileReader fileReader = new FileReader(file);
			BufferedReader bufferedReader = new BufferedReader(fileReader);
			int ID = Integer.parseInt(bufferedReader.readLine());
			
			String response = null;
			CreateDataSourceRecord createDSRecord = new CreateDataSourceRecord();
			
			JSONObject payloadObj = new JSONObject(payload);
			JSONArray payloadResultsArray = (JSONArray)payloadObj.get("results");
			
			for(int counter = 0 ; counter < payloadResultsArray.length(); counter ++){
				JSONObject eventsDataSourcePayload = new JSONObject();
				JSONObject resultRowObj = new JSONObject( payloadResultsArray.getString(counter));
				if(Integer.parseInt(resultRowObj.getString("id")) > ID){
					try{
						eventsDataSourcePayload.put("Event_ID", resultRowObj.getString("id"));
						eventsDataSourcePayload.put("STARTDATETIME", resultRowObj.getString("created"));
						eventsDataSourcePayload.put("ENDDATETIME", resultRowObj.getString("created"));
						eventsDataSourcePayload.put("LASTUPDATEDATETIME", resultRowObj.getString("modified"));				
						String location = "POINT("+resultRowObj.getString("longitude")+" "+resultRowObj.getString("latitude")+")";							
						eventsDataSourcePayload.put("LOCATION", location);
						eventsDataSourcePayload.put("TIMEZONEOFFSET", "0");
						eventsDataSourcePayload.put("type", resultRowObj.getString("type"));	
						eventsDataSourcePayload.put("severity", resultRowObj.getString("severity"));
						eventsDataSourcePayload.put("cause", resultRowObj.getString("cause"));
						eventsDataSourcePayload.put("status", resultRowObj.getString("status"));
						try{
							JSONObject ownerObj = new JSONObject(resultRowObj.getString("owner"));
							eventsDataSourcePayload.put("username", ownerObj.getString("username"));
						}catch(Exception e){
							logger.error("{	Exception@ owner obj	}	"+e);
							e.printStackTrace();
						}
						System.out.println(eventsDataSourcePayload);
						if(resultRowObj.getString("responder_vehicle").length()>0 || resultRowObj.getString("responder_vehicle")!=null){
							JSONArray responderVehicleArray = (JSONArray)resultRowObj.get("responder_vehicle");
							for(int count = 0 ;count < responderVehicleArray.length(); count++){
								if(responderVehicleArray.get(count)!=null){
									try{
										JSONObject responderVechicleObj = (JSONObject)responderVehicleArray.get(count);
										eventsDataSourcePayload.put("vehicletype", responderVechicleObj.getString("vehicle_type"));
										eventsDataSourcePayload.put("agencyname", responderVechicleObj.getString("agency_name"));
									}catch(Exception e){
										logger.error("{	Exception@ vehicle type }  "+e);
									}
								}
							}					
						}
						response = createDSRecord.createDataSourceRecord(config.eventsDatasourceID(), eventsDataSourcePayload.toString());
						logger.info(response +"  ID "+"{"+ resultRowObj.getString("id") +"}");
						if(response.contains("200")){
							FileWriter writer = new FileWriter(file);
							writer.write(resultRowObj.getString("id"));
							writer.close();
						}
					}catch(Exception e){
						logger.error("{	Excrption }	"+e);
					}
				}
			}			
			
		} catch (Exception e) {
			logger.error("{	Exception }	"+e);
			e.printStackTrace();			
		}
		
	}
}
